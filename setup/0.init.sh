#!/bin/sh

: ${USE_VOX:="true"}
# http://patorjk.com/software/taag/#p=display&f=ANSI%20Shadow

speaker () {
  WELCOME=$1
  echo $WELCOME
  if [ "$USE_VOX" = "true" ]; then
    if type "say"        > /dev/null 2> /dev/null; then
      say "$WELCOME"
    elif type "espeak"   > /dev/null 2> /dev/null; then
      espeak "$WELCOME"
    elif type "spd-say"  > /dev/null 2> /dev/null; then
      spd-say "$WELCOME"
    elif type "festival" > /dev/null 2> /dev/null; then
      echo "$WELCOME" | festival --tts
    fi
  fi
}

speaker 'Welcome to transmute, this guide will help you setup your environment. Before we get started, be sure to update your transmute-config.'


# ███████╗███████╗████████╗██╗   ██╗██████╗      ██████╗ ██████╗ ███╗   ██╗███████╗██╗ ██████╗ 
# ██╔════╝██╔════╝╚══██╔══╝██║   ██║██╔══██╗    ██╔════╝██╔═══██╗████╗  ██║██╔════╝██║██╔════╝ 
# ███████╗█████╗     ██║   ██║   ██║██████╔╝    ██║     ██║   ██║██╔██╗ ██║█████╗  ██║██║  ███╗
# ╚════██║██╔══╝     ██║   ██║   ██║██╔═══╝     ██║     ██║   ██║██║╚██╗██║██╔══╝  ██║██║   ██║
# ███████║███████╗   ██║   ╚██████╔╝██║         ╚██████╗╚██████╔╝██║ ╚████║██║     ██║╚██████╔╝
# ╚══════╝╚══════╝   ╚═╝    ╚═════╝ ╚═╝          ╚═════╝ ╚═════╝ ╚═╝  ╚═══╝╚═╝     ╚═╝ ╚═════╝ 
                                                                                             

if [ -e "./transmute-config/.env" ]; then
  echo 'Transmute Config has been found here:\n'
  echo ' - ./transmute-config/.env'
else
  speaker "Would you like me to copy the example environment?" answer
  read -p "[yn]" answer
  if [ "$answer" = y ] ; then
      # run the command
      cp ./transmute-config/.example.env  ./transmute-config/.env 
  fi
fi

read -p "Press enter to continue" answer

. ./transmute-config/.env

# ██╗███╗   ██╗███████╗████████╗ █████╗ ██╗     ██╗         ██╗  ██╗ ██████╗ ███╗   ██╗ ██████╗ 
# ██║████╗  ██║██╔════╝╚══██╔══╝██╔══██╗██║     ██║         ██║ ██╔╝██╔═══██╗████╗  ██║██╔════╝ 
# ██║██╔██╗ ██║███████╗   ██║   ███████║██║     ██║         █████╔╝ ██║   ██║██╔██╗ ██║██║  ███╗
# ██║██║╚██╗██║╚════██║   ██║   ██╔══██║██║     ██║         ██╔═██╗ ██║   ██║██║╚██╗██║██║   ██║
# ██║██║ ╚████║███████║   ██║   ██║  ██║███████╗███████╗    ██║  ██╗╚██████╔╝██║ ╚████║╚██████╔╝
# ╚═╝╚═╝  ╚═══╝╚══════╝   ╚═╝   ╚═╝  ╚═╝╚══════╝╚══════╝    ╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═══╝ ╚═════╝ 
                                                                                              
speaker 'Great, your environment has been established...\!'

echo 'MINIKUBE_IP ' $MINIKUBE_IP

echo ''

. ./setup/1.install_kong.sh

echo 'Now ready to configure SSL...'

#  ██████╗ ██████╗ ███╗   ██╗███████╗██╗ ██████╗     ███████╗███████╗██╗     
# ██╔════╝██╔═══██╗████╗  ██║██╔════╝██║██╔════╝     ██╔════╝██╔════╝██║     
# ██║     ██║   ██║██╔██╗ ██║█████╗  ██║██║  ███╗    ███████╗███████╗██║     
# ██║     ██║   ██║██║╚██╗██║██╔══╝  ██║██║   ██║    ╚════██║╚════██║██║     
# ╚██████╗╚██████╔╝██║ ╚████║██║     ██║╚██████╔╝    ███████║███████║███████╗
#  ╚═════╝ ╚═════╝ ╚═╝  ╚═══╝╚═╝     ╚═╝ ╚═════╝     ╚══════╝╚══════╝╚══════╝
                                                                           

. ./setup/2.ngrok_kong_ssl.sh

echo 'Now ready to install IPFS...'

read -p "Press enter to continue"


# ██╗███╗   ██╗███████╗████████╗ █████╗ ██╗     ██╗         ██╗██████╗ ███████╗███████╗
# ██║████╗  ██║██╔════╝╚══██╔══╝██╔══██╗██║     ██║         ██║██╔══██╗██╔════╝██╔════╝
# ██║██╔██╗ ██║███████╗   ██║   ███████║██║     ██║         ██║██████╔╝█████╗  ███████╗
# ██║██║╚██╗██║╚════██║   ██║   ██╔══██║██║     ██║         ██║██╔═══╝ ██╔══╝  ╚════██║
# ██║██║ ╚████║███████║   ██║   ██║  ██║███████╗███████╗    ██║██║     ██║     ███████║
# ╚═╝╚═╝  ╚═══╝╚══════╝   ╚═╝   ╚═╝  ╚═╝╚══════╝╚══════╝    ╚═╝╚═╝     ╚═╝     ╚══════╝
                                                                                     
. ./setup/3.install_ipfs.sh


# ██╗███╗   ██╗███████╗████████╗ █████╗ ██╗     ██╗          ██████╗  █████╗ ███╗   ██╗ █████╗  ██████╗██╗  ██╗███████╗
# ██║████╗  ██║██╔════╝╚══██╔══╝██╔══██╗██║     ██║         ██╔════╝ ██╔══██╗████╗  ██║██╔══██╗██╔════╝██║  ██║██╔════╝
# ██║██╔██╗ ██║███████╗   ██║   ███████║██║     ██║         ██║  ███╗███████║██╔██╗ ██║███████║██║     ███████║█████╗  
# ██║██║╚██╗██║╚════██║   ██║   ██╔══██║██║     ██║         ██║   ██║██╔══██║██║╚██╗██║██╔══██║██║     ██╔══██║██╔══╝  
# ██║██║ ╚████║███████║   ██║   ██║  ██║███████╗███████╗    ╚██████╔╝██║  ██║██║ ╚████║██║  ██║╚██████╗██║  ██║███████╗
# ╚═╝╚═╝  ╚═══╝╚══════╝   ╚═╝   ╚═╝  ╚═╝╚══════╝╚══════╝     ╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═══╝╚═╝  ╚═╝ ╚═════╝╚═╝  ╚═╝╚══════╝
                                                                                                                     
. ./setup/4.install_ganache.sh
